#Background - In this SQL, I used SQLiteStudio to query a database with multiple tables to quantify statistics about customer and order data. 


#How many orders were placed in January? (These results filter out "messy/bad data" in the orderID attribute)
SELECT COUNT(orderid)
FROM JanSales
WHERE length(orderid) = 6
AND orderid <> 'Order ID';

#How many of those orders were for a iPhone?
SELECT COUNT(*) 
FROM JanSales
WHERE length(orderID) = 6
AND orderID <> 'Order ID'
AND Product = 'iPhone';

#Select the customer account numbers for all the orders that were placed in February.
SELECT DISTINCT c.acctnum
FROM customers c
INNER JOIN FebSales f
ON c.order_id = f.orderID
WHERE length(orderID) = 6
AND orderID <> 'Order ID';

#Which product was the cheapest one sold in January and what was the price?
SELECT DISTINCT product, price
FROM JanSales
ORDER BY price asc
LIMIT 1;

#What is the total revenue for each product sold in January?
SELECT product,SUM(quantity)*price AS revenue
FROM JanSales
WHERE product <> ''
GROUP BY product;

#Which products were sold in February at 548 Lincoln St, Seattle, WA 98101? How many of each were sold and what was the total revenue?
SELECT product,SUM(quantity)*price AS revenue, SUM(quantity)
FROM FebSales
WHERE product <> ''
AND location = '548 Lincoln St, Seattle, WA 98101'
GROUP BY product;

#How many customers ordered more than 2 products at a time and what was the average amount spent for those customers?
SELECT COUNT(DISTINCT c.acctnum),AVG(f.quantity*f.price)
FROM FebSales f
LEFT JOIN customers c
ON f.orderid = c.order_id
WHERE f.quantity > 2
AND LENGTH(orderid) = 6
AND orderid <> 'Order ID';


 

